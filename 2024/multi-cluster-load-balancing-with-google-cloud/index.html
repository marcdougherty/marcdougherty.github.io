<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=dark data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en-us"><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=theme-color><title>Multi-cluster load balancing with Google Cloud &#183; Marc Dougherty</title><meta name=title content="Multi-cluster load balancing with Google Cloud &#183; Marc Dougherty"><meta name=keywords content="reliability,kubernetes,load balancing,"><link rel=canonical href=https://www.marcdougherty.com/2024/multi-cluster-load-balancing-with-google-cloud/><meta name=author content="Marc Dougherty"><link href=https://github.com/muncus rel=me><link href=https://twitter.com/muncus rel=me><link href=https://dev.to/muncus rel=me><link href=https://medium.com/@muncus rel=me><link href=https://linkedin.com/in/doughertymarc rel=me><link href=https://muncus.github.io rel=me><meta property="og:url" content="https://www.marcdougherty.com/2024/multi-cluster-load-balancing-with-google-cloud/"><meta property="og:site_name" content="Marc Dougherty"><meta property="og:title" content="Multi-cluster load balancing with Google Cloud"><meta property="og:description" content="To build a high-availability service in the cloud, we need to be able to serve from multiple independent failure domains. We can achieve this with multiple kubernetes clusters in different cloud regions, but we’ll need a load balancer that can route to all of our clusters.
This article will provide an overview of 3 possible options for load balancing between kubernetes clusters on Google Cloud. Because I’m looking at this through the lens of Platform Engineering, I’ll also be discussing the breakdown of responsibilities and controls between a Platform team and an Application team."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-06-27T13:17:33-07:00"><meta property="article:modified_time" content="2024-06-27T13:17:33-07:00"><meta property="article:tag" content="Reliability"><meta property="article:tag" content="Kubernetes"><meta property="article:tag" content="Load Balancing"><meta name=twitter:card content="summary"><meta name=twitter:title content="Multi-cluster load balancing with Google Cloud"><meta name=twitter:description content="To build a high-availability service in the cloud, we need to be able to serve from multiple independent failure domains. We can achieve this with multiple kubernetes clusters in different cloud regions, but we’ll need a load balancer that can route to all of our clusters.
This article will provide an overview of 3 possible options for load balancing between kubernetes clusters on Google Cloud. Because I’m looking at this through the lens of Platform Engineering, I’ll also be discussing the breakdown of responsibilities and controls between a Platform team and an Application team."><link type=text/css rel=stylesheet href=/css/main.bundle.min.96f798a0539953ba90672417dafa9e567e2b272b5d2392a03a1ca789fc4d2052ce8e8dde590e4a68a6a3c957e962852db390c7f7d95be3129c3f285c76eb39d9.css integrity="sha512-lveYoFOZU7qQZyQX2vqeVn4rJytdI5KgOhynifxNIFLOjo3eWQ5KaKajyVfpYoUts5DH99lb4xKcPyhcdus52Q=="><script type=text/javascript src=/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js integrity="sha512-b0EXSzoFtoCCD+CMrb+l+3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script><script src=/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7+kfJ6kKCJxQGC+8wm+Bz9JucDjDTGNew=="></script><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.c586c752b99483da1d0b024cb91220f5defda40000f3549b073a52dea6c99c78c50d376eb71e78969112c5dbc24bc4001182bd096c47d2e025053efd92d91b4c.js integrity="sha512-xYbHUrmUg9odCwJMuRIg9d79pAAA81SbBzpS3qbJnHjFDTdutx54lpESxdvCS8QAEYK9CWxH0uAlBT79ktkbTA==" data-copy=Copy data-copied=Copied></script><script src=/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj+KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Multi-cluster load balancing with Google Cloud","headline":"Multi-cluster load balancing with Google Cloud","abstract":"\u003cp\u003eTo build a high-availability service in the cloud, we need to be able to serve from multiple independent failure domains. We can achieve this with multiple kubernetes clusters in different cloud regions, but we\u0026rsquo;ll need a load balancer that can route to all of our clusters.\u003c\/p\u003e\n\u003cp\u003eThis article will provide an overview of 3 possible options for load balancing between kubernetes clusters on Google Cloud. Because I\u0026rsquo;m looking at this through the lens of Platform Engineering, I\u0026rsquo;ll also be discussing the breakdown of responsibilities and controls between a Platform team and an Application team.\u003c\/p\u003e","inLanguage":"en-us","url":"https:\/\/www.marcdougherty.com\/2024\/multi-cluster-load-balancing-with-google-cloud\/","author":{"@type":"Person","name":"Marc Dougherty"},"copyrightYear":"2024","dateCreated":"2024-06-27T13:17:33-07:00","datePublished":"2024-06-27T13:17:33-07:00","dateModified":"2024-06-27T13:17:33-07:00","keywords":["reliability","kubernetes","load balancing"],"mainEntityOfPage":"true","wordCount":"1232"}]</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-31G86DYMCL"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-31G86DYMCL")</script></head><body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
Skip to main content</a></div><div class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0"><div class="flex flex-1 items-center justify-between"><nav class="flex space-x-3"><a href=/ class="text-base font-medium">Marc Dougherty</a></nav><nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12"><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-base font-medium">Blog</p></a><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-base font-medium">Tags</p></a><a href=/archive/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Archive title=Archives><p class="text-base font-medium">Archive</p></a><button id=search-button aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></button><div class="flex items-center"><button id=appearance-switcher aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></nav><div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12"><span></span>
<button id=search-button-mobile aria-label=Search class="text-base hover:text-primary-600 dark:hover:text-primary-400" title="Search (/)">
<span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></button>
<button id=appearance-switcher-mobile aria-label="Dark mode switcher" type=button class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1"><div class="flex items-center justify-center dark:hidden"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden dark:flex"><span class="relative block icon"><svg viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div><div class="-my-2 md:hidden"><div id=menu-button class=block><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]"><ul class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl"><li id=menu-close-button><span class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400"><span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class=mt-1><a href=/posts/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Blog title=Posts><p class="text-bg font-bg">Blog</p></a></li><li class=mt-1><a href=/tags/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Tags title=Tags><p class="text-bg font-bg">Tags</p></a></li><li class=mt-1><a href=/archive/ class="flex items-center hover:text-primary-600 dark:hover:text-primary-400" aria-label=Archive title=Archives><p class="text-bg font-bg">Archive</p></a></li></ul></div></div></div></div><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header id=single_header class="mt-5 max-w-prose"><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Multi-cluster load balancing with Google Cloud</h1><div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime=2024-06-27T13:17:33-07:00>27 June 2024</time><span class="px-2 text-primary-500">&#183;</span><span>1232 words</span><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">6 mins</span></div><div class="flex flex-row flex-wrap items-center"><a class="relative mt-[0.5rem] me-2" href=/tags/reliability/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Reliability
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/kubernetes/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Kubernetes
</span></span></a><a class="relative mt-[0.5rem] me-2" href=/tags/load-balancing/><span class="flex cursor-pointer"><span class="rounded-md border border-primary-400 px-1 py-[1px] text-xs font-normal text-primary-700 dark:border-primary-600 dark:text-primary-400">Load Balancing</span></span></a></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs"><div class="toc ps-5 print:hidden lg:sticky lg:top-10"><details open id=TOCView class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#plain-load-balancing>&ldquo;Plain&rdquo; Load Balancing</a></li><li><a href=#multi-cluster-ingress>Multi-Cluster Ingress</a></li><li><a href=#multi-cluster-gateway>Multi-Cluster Gateway</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></details><details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden"><summary class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#plain-load-balancing>&ldquo;Plain&rdquo; Load Balancing</a></li><li><a href=#multi-cluster-ingress>Multi-Cluster Ingress</a></li><li><a href=#multi-cluster-gateway>Multi-Cluster Gateway</a></li><li><a href=#conclusions>Conclusions</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-fit"><details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">Platform Thoughts -
This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">Part :
This Article</div></details><div class="article-content max-w-prose mb-20"><p>To build a high-availability service in the cloud, we need to be able to serve from multiple independent failure domains. We can achieve this with multiple kubernetes clusters in different cloud regions, but we&rsquo;ll need a load balancer that can route to all of our clusters.</p><p>This article will provide an overview of 3 possible options for load balancing between kubernetes clusters on Google Cloud. Because I&rsquo;m looking at this through the lens of Platform Engineering, I&rsquo;ll also be discussing the breakdown of responsibilities and controls between a Platform team and an Application team.</p><h2 class="relative group">&ldquo;Plain&rdquo; Load Balancing<div id=plain-load-balancing class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#plain-load-balancing aria-label=Anchor>#</a></span></h2><p>The &ldquo;plain&rdquo; load balancing model is the most flexible, since it uses GCP Load Balancing primitives. You can use any of the (many!) available options on the load balancers, since you are creating them directly.</p><p>This strategy is essentially the same as my previous post called &ldquo;<a href=https://www.marcdougherty.com/2024/architecting-for-traffic-drains/ target=_blank>Architecting for Drains</a>&rdquo;, where you create a Backend Service from the Network Endpoint Groups (NEGs) that Google Cloud creates for your Service in each of your clusters.</p><p>I strongly recommend using an Infrastructure as Code tool like Terraform to manage your load balancers. This is especially helpful in this case, since finding the NEG information manually in the UI is tedious and prone to error.</p><p>First, the Kubernetes Services in each cluster must be made publicly available. To achieve this, you create a <code>Service</code> and <code>Ingress</code> object like this:</p><pre tabindex=0><code>apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  type: LoadBalancer
  selector:
    app: my-service
  ports:
  - name: web
    port: 8080
    targetPort: 8080
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: my-service
 spec:
  defaultService:
    kind: Service
    name: my-service
</code></pre><p>Once these objects are created, Google Cloud will automatically create Regional Load balancers for each service in each cluster. Importantly, a Network Endpoint Group is created for the <code>Service</code> object, and the name of this NEG is stored in an annotation called <code>cloud.google.com/neg-status</code>. With this information about the NEG, we can now create our own load balancer, using the NEGs from each of our clusters, to form a Global service.</p><p>Creating a Public, Global Application Load Balancer creates the following objects:</p><ul><li>A <a href=https://cloud.google.com/load-balancing/docs/forwarding-rule-concepts target=_blank>global forwarding rule</a> - which directs external traffic to a Target Proxy.</li><li>A <a href=https://cloud.google.com/load-balancing/docs/target-proxies target=_blank>Target Proxy</a> - Target Proxies tie forwarding rules to URL Maps. Target Proxies come in different types by protocol: HTTP, HTTPS, GRPC, etc.</li><li>A <a href=https://cloud.google.com/load-balancing/docs/url-map-concepts target=_blank>URL Map</a> - uses various matching rules to direct incoming requests to the appropriate backend service.</li><li>A <a href=https://cloud.google.com/load-balancing/docs/backend-service target=_blank>Backend Service</a> - contains one or more destinations that can serve incoming requests. The Backend Service describes how to connect and balance traffic for each destination (this is where our NEGs come in).</li><li>A <a href=https://cloud.google.com/load-balancing/docs/health-check-concepts target=_blank>Health Check</a> - ensures that each destination in your Backend Service is healthy and capable of serving requests. Destinations that fail health checks will not receive requests.</li></ul><p>The <a href=http://github.com/muncus/drain-demo target=_blank>drain-demo repository</a> includes an example of working terraform to create this global load balancer. Specifically, <a href=https://github.com/muncus/drain-demo/blob/main/02-loadbalancer/global-lb.tf%5c#L17-L29 target=_blank>parsing the NEG information out of the annotations is covered here</a>.</p><p>As for the division of responsibilities, a Platform team could own the Global load balancing through terraform, while each application team is responsible for creating the relevant <code>Service</code> and <code>Ingress</code> objects in their cluster.</p><h2 class="relative group">Multi-Cluster Ingress<div id=multi-cluster-ingress class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#multi-cluster-ingress aria-label=Anchor>#</a></span></h2><p><a href=https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress target=_blank>Multi-Cluster Ingress</a> (MCI) is Google&rsquo;s first managed multi-cluster routing product. It uses kubernetes Custom Resource Definitions (CRDs) for configuration. Like Google&rsquo;s other managed multi-cluster solution, MCI requires a GKE Enterprise subscription.</p><p>The two relevant CRDs for MCI are <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/multi-cluster-ingress%5c#multiclusterservice%5c_spec target=_blank><code>MultiClusterService</code></a> and <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/multi-cluster-ingress%5c#multiclusteringress%5c_spec target=_blank><code>MultiClusterIngress</code></a>. These resources must be deployed on the GKE-Enterprise config cluster, which acts as the source of truth</p><p><code>MultiClusterService</code> uses a label-based selector to find pods in your
clusters:</p><pre tabindex=0><code>apiVersion: networking.gke.io/v1
kind: MultiClusterService
metadata:
  name: my-service￼
spec:
  template:
    spec:
      selector:
        app: my-app
      ports:
      - name: web
        protocol: TCP
        port: 8080￼
        targetPort: 8080
</code></pre><p>Once you have at least one service defined, you can make a <code>MultiClusterIngress</code> to route requests to your service:</p><pre tabindex=0><code>apiVersion: networking.gke.io/v1
kind: MultiClusterIngress
metadata:
  name: NAME￼
  namespace: NAMESPACE￼
spec:
  template:
    spec:
      backend:
       serviceName: my-service￼
       servicePort: 8080￼
</code></pre><p>This example routes all requests to <code>my-service</code>, but <code>MultiClusterIngress</code> also supports various rules to route requests based on the Host header or URL path.</p><p>Because MCI is the &ldquo;original&rdquo; managed multi-cluster service, it supports only the &ldquo;Legacy&rdquo; type of Cloud Load Balancer.</p><p>As for the division of responsibility, MCI requires changes to kubernetes objects in the GKE-E Config Cluster. Because these objects form a global control plane, any changes to these objects will require involvement from the Platform / Infrastructure team.</p><h2 class="relative group">Multi-Cluster Gateway<div id=multi-cluster-gateway class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#multi-cluster-gateway aria-label=Anchor>#</a></span></h2><p>Multi-Cluster Gateway (MCG) is Google Cloud&rsquo;s implementation of the <a href=https://gateway-api.sigs.k8s.io/ target=_blank>Kubernetes Gateway API</a> - a vendor-agnostic collection of kubernetes objects that can be used to configure incoming traffic. While the Gateway API (and Google&rsquo;s implementation) can be used to make per-cluster gateways, we&rsquo;ll be focusing on the multi-cluster use case.</p><p>The Gateway API consists of the following components:</p><ul><li><code>GatewayClass</code> decides how different classes of Gateway are created and managed. You can think of this as a way to declare which Controller is responsible for each Class of gateway. These are <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/gatewayclass-capabilities target=_blank>predefined by Google Cloud</a>, so it is just a matter of picking the option that best suits your needs.</li><li><code>Gateway</code> represents the load balancer itself. Routing rules are attached to the Gateway with protocol-specific objects like <code>HTTPRoute</code>.</li></ul><pre tabindex=0><code>kind: Gateway
apiVersion: gateway.networking.k8s.io/v1beta1
metadata:
  name: external-http
  namespace: default
spec:
  gatewayClassName: gke-l7-global-external-managed-mc
  listeners:
  - name: http
    protocol: HTTP
    port: 80
</code></pre><ul><li><code>ServiceExport</code> objects indicate that the named <code>Service</code> object should be made available to other clusters. The GKE Gateway controller will create the corresponding <code>ServiceImport</code> objects in all clusters, which are used in <code>HTTPRoute</code> objects.</li></ul><pre tabindex=0><code>kind:ServiceExport
apiVersion: net.gke.io/v1
metadata:
  name: my-service
  namespace: default
</code></pre><ul><li><code>HTTPRoute</code> objects contain rules for directing HTTP traffic to a backend service. In our multi-cluster routing setup, these will be <code>ServiceImport</code> references, to indicate that this service is present in multiple clusters.</li></ul><pre tabindex=0><code>kind: HTTPRoute
apiVersion: gateway.networking.k8s.io/v1beta1
metadata:
  name: example-route
  namespace: default
  spec:
  parentRefs:
  - kind: Gateway
    namespace: default
    name: external-http
  hostnames:
  - &#34;example.com&#34;
  rules:
  - backendRefs:
    - group: net.gke.io
      kind: ServiceImport
      name: my-service
      port: 8080
</code></pre><p>The Google Cloud tutorial for a <a href=https://cloud.google.com/kubernetes-engine/docs/how-to/deploying-multi-cluster-gateways%5c#external-gateway target=_blank>Multi-cluster, multi-region external gateway</a> provides sample objects of all of these types, and is a good illustration of how to use them.</p><p>The Kubernetes Gateway group considered the separation of responsibility as a core part of their API, and it shows. One way to split this would be to have a Platform team that owns all <code>Gateway</code> and <code>HTTPRoute</code> objects, while application teams are responsible for their <code>ServiceExport</code> objects.
The API is flexible enough to allow for some application teams to own their own <code>HTTPRoute</code>s, or even their own <code>Gateway</code>s as desired.</p><h2 class="relative group">Conclusions<div id=conclusions class=anchor></div><span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none"><a class="text-primary-300 dark:text-neutral-700 !no-underline" href=#conclusions aria-label=Anchor>#</a></span></h2><p>Multi-cluster load balancing is a complex topic, and we&rsquo;ve barely scratched the surface with an overview of 3 approaches.</p><ul><li>&ldquo;Plain&rdquo; load balancing (perhaps better called &ldquo;composite load balancing&rdquo;?) reuses per-cluster Network Endpoint Groups in the creation of a global load balancer. It provides flexibility but requires considerable management to set up.</li><li>Multi-cluster Ingress, which is specific to Google Cloud, and has poor support for advanced load balancing features.</li><li>Multi-cluster Gateway, which is an implementation of a Kubernetes API, and supports most available load balancing features.</li></ul><p>If you need an even greater degree of control over your traffic, you may also want to consider using a <a href="https://cloud.google.com/products/service-mesh?hl=en" target=_blank>Service Mesh</a>. Service Mesh provides a great deal more than just load balancing, but for environments that want a more robust set of controls on inter-service communication, it may be the right choice.</p></div><details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5"><summary class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">Platform Thoughts -
This article is part of a series.</summary><div class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">Part :
This Article</div></details></div><script type=text/javascript src=/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA==" data-oid=views_posts/multicluster-load-balancing.md data-oid-likes=likes_posts/multicluster-load-balancing.md></script></section><footer class="pt-8 max-w-prose print:hidden"></footer></article><div id=scroll-to-top class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200"><a href=#the-top class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer id=site-footer class="py-10 print:hidden"><div class="flex items-center justify-between"><p class="text-sm text-neutral-500 dark:text-neutral-400">&copy;
2026
Marc Dougherty</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://blowfish.page/ target=_blank rel="noopener noreferrer">Blowfish</a></p></div><script>mediumZoom(document.querySelectorAll("img:not(.nozoom)"),{margin:24,background:"rgba(0,0,0,0.5)",scrollOffset:0})</script><script type=text/javascript src=/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh+sCQ0E53ghYrxgYqw+0GCRyIEpA=="></script></footer><div id=search-wrapper class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500" data-url=https://www.marcdougherty.com/><div id=search-modal class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex items-center justify-between flex-none px-2"><form class="flex items-center flex-auto min-w-0"><div class="flex items-center justify-center w-8 h-8 text-neutral-400"><span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="relative block icon"><svg viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto px-2 overflow-auto"><ul id=search-results></ul></section></div></div></div></body></html>